{"version":3,"file":null,"sources":["src/server/log.js","src/utils/guid.js","src/utils/randomInt.js","src/utils/shallow-equal.js","src/utils/changed.js","src/model/client-action-state/roll-dices.js","src/model/client-action-state/introduction.js","src/model/client-action-state/class-selection.js","src/model/client-action-state/town-lobby.js","src/model/action-state-reducer.js","src/model/context-reducer.js","src/model/global-reducer.js","src/server/states/introduction.js","src/server/states/class-selection.js","src/model/selectors/global.js","src/model/selectors/client.js","src/server/states/town-lobby.js","src/model/selectors/client-action-state.js","src/server/states/roll-dices.js","src/server/middleware/server-middleware.js","src/server/middleware/response-middleware.js","src/server/server-io.js","src/server/index.js"],"sourcesContent":["const winston = require('winston')\nconst path = require('path')\n\nconst logger = new (winston.Logger)({\n  transports: [\n    new (winston.transports.Console)(),\n    new (winston.transports.File)({ filename: path.join(__dirname, 'data/server.log')})\n  ]\n})\n\nexport default {\n  debug(...args){\n    logger.debug(...args)\n  },\n  info(...args){\n    logger.info(...args)\n  },\n  warn(...args){\n    logger.warn(...args)\n  },\n  error(...args){\n    logger.error(...args)\n  }\n}","function s4() {\n  return Math.floor((1 + Math.random()) * 0x10000)\n    .toString(16)\n    .substring(1);\n}\n\nexport default function guid() {\n\n  return s4() + s4() + '-' + s4() + '-' + s4() + '-' +\n    s4() + '-' + s4() + s4() + s4()\n}\n","export default function randomInt(min, max) {\n  min = Math.ceil(min);\n  max = Math.floor(max);\n  return Math.floor(Math.random() * (max - min)) + min;\n}\n","export default function shallowEqual(oldState, newState){\n  const resultOldToNew = Object.keys(oldState).reduce((result, oldKey) => {\n    return result === true ? result : oldState[oldKey] !== newState[oldKey]\n  }, false)\n\n  const resultNewToOld = Object.keys(newState).reduce((result, newKey) => {\n    return result === true ? result : oldState[newKey] !== newState[newKey]\n  }, false)\n\n  return !resultNewToOld && !resultOldToNew\n}","import shallowEqual from './shallow-equal'\n\nexport default function changed(oldState, newState){\n\n  return shallowEqual(oldState, newState) ? oldState : newState\n}","const ROLL = 'ROLL_DICES:ROLL'\nconst LOCK = 'ROLL_DICES:LOCK'\n\nexport function roll(guid, rolledDices){\n  return {\n    type: ROLL,\n    guid : guid,\n    rolledDices : rolledDices\n  }\n}\n\nexport function lock(guid, locks){\n  return {\n    type: LOCK,\n    guid: guid,\n    locks : locks\n  }\n}\n\nconst initialState = {\n  name: 'rollDices',\n  rolledDices: [],\n  locks:[],\n  numberOfRolls: 0\n}\n\nexport default function rollDices(state = initialState, action) {\n  switch (action.type) {\n    case ROLL:\n      return {\n        ...state,\n        rolledDices: action.rolledDices,\n        numberOfRolls: (state.numberOfRolls+1)\n      }\n    case LOCK:\n      return {\n        ...state,\n        locks : action.locks\n      }\n    default :\n      return state\n  }\n}","const initialState = {\n  name: 'introduction'\n}\n\nexport default function introduction(state = initialState, action) {\n  switch (action.type) {\n    default :\n      return state\n  }\n}","const initialState = {\n  name: 'classSelection'\n}\n\nexport default function classSelection(state = initialState, action) {\n  switch (action.type) {\n    default :\n      return state\n  }\n}","const initialState = {\n  name: 'townLobby'\n}\n\nexport default function townLobby(state = initialState, action) {\n  switch (action.type) {\n    default :\n      return state\n  }\n}","import {shallowEqual} from '../utils'\nimport * as clientActionReducers from './client-action-state'\n\nexport default function actionStateReducer(state = [], action) {\n  switch (action.type) {\n    case 'CLIENT_STATE_ENTER_PUSH':\n      return state.concat(clientActionReducers[action.name](undefined, {type:'@INIT@'}))\n    case 'CLIENT_STATE_POP' :\n      return state.slice(0,state.length-1)\n    case 'CLIENT_STATE_ENTER_REPLACE' :\n      return state.slice(0,state.length-1).concat(clientActionReducers[action.name](undefined, {type:'@INIT@'}))\n    default :{\n      if(state.length === 0) return state\n      const topState = state[state.length - 1]\n      const topStateName = topState.name\n      const reducer = clientActionReducers[topStateName]\n      if(reducer){\n        const newTopState = reducer(topState, action)\n        if(shallowEqual(topState, newTopState)){\n          return state\n        } else {\n          return state.slice(0,state.length-1).concat(newTopState)\n        }\n      }\n      return state\n    }\n  }\n}","import {guid as guidGenerator} from '../utils'\nimport {changed} from '../utils'\nimport actionStateReducer from './action-state-reducer'\n\nexport function message(from, to, message){\n  return {\n    type: 'MESSAGE',\n    id: guidGenerator(),\n    from: from,\n    guid: (to !== 'all'? to : undefined),\n    to: to,\n    message: message\n  }\n}\n\nexport function setState(guid, name){\n  return {\n    type : 'CLIENT_STATE_ENTER_REPLACE',\n    guid : guid,\n    name : name\n  }\n}\n\nexport function pushState(guid, name){\n  return {\n    type: 'CLIENT_STATE_ENTER_PUSH',\n    guid: guid,\n    name: name\n  }\n}\n\nexport function popState(guid) {\n  return {\n    type: 'CLIENT_STATE_POP',\n    guid: guid\n  }\n}\n\nexport function setName(guid, name){\n  return {\n    type : 'CLIENT_SET_NAME',\n    guid : guid,\n    name : name\n  }\n}\n\nexport function setClass(guid, className){\n  return {\n    type : 'CLIENT_SET_CLASS',\n    guid : guid,\n    name : className\n  }\n}\n\nconst initialState = {\n  name : 'Noname',\n  className: 'Noone',\n  actionState:[],\n  messages : [{\n    id : guidGenerator(),\n    from : 'Chat System',\n    to : 'all',\n    message : 'Welcome to chat'\n  }]\n}\n\nexport default function contextReducer(state = initialState, action){\n  switch(action.type){\n    case 'MESSAGE' : return {\n      ...state,\n      messages : state.messages.concat({\n        id : action.id,\n        from: action.from,\n        to: action.to,\n        message: action.message\n      })\n    }\n    case 'CLIENT_SET_NAME' : return {\n      ...state,\n      name : action.name\n    }\n    case 'CLIENT_SET_CLASS' : return {\n      ...state,\n      className : action.name\n    }\n    case 'LOAD_CLIENT_STATE' : return action.state\n    default: return changed(state, {\n      ...state,\n      actionState : actionStateReducer(state.actionState, action)\n    })\n  }\n}\n","import sharedContextReducer from './context-reducer'\nimport {combineReducers} from 'redux'\nimport {changed} from '../utils'\n\nconst initialState = {\n  connected : false,\n  shared : sharedContextReducer(undefined, {type:'@INIT@'})\n}\n\nfunction clientContextReducer(state = initialState, action){\n  switch (action.type){\n    case 'CONTEXT_SPAWNED': return {\n      shared : sharedContextReducer(state.shared, action),\n      connected: true\n    }\n    case 'CONTEXT_DESPAWNED': return {\n      shared: sharedContextReducer(state.shared, action),\n      connected: false\n    }\n    default : return changed(state, {\n      ...state,\n      shared : sharedContextReducer(state.shared, action)\n    })\n  }\n}\n\nfunction allContextsReducer(state = {}, action){\n  switch(action.type){\n    case 'CONTEXT_SPAWNED': return {...state, [action.guid]: clientContextReducer(state[action.guid], action)}\n    case 'CONTEXT_DESPAWNED': return {...state, [action.guid]: clientContextReducer(state[action.guid], action)}\n    default : return changed(state, Object.keys(state).reduce((newState, context) => {\n      if(action.guid){\n        if(action.guid === context){\n          newState[context] = clientContextReducer(state[context], action)\n        } else {\n          newState[context] = state[context]\n        }\n      } else {\n        newState[context] = clientContextReducer(state[context], action)\n      }\n\n      return newState\n    }, {}))\n  }\n}\n\nexport default combineReducers({\n  contexts : allContextsReducer\n})\n","import {message, setState, setName} from '../../model/context-reducer'\n\nexport default {\n  onEnter: (guid, getState, dispatch)=>{\n    dispatch(message('GM', guid, 'You are entering town gate, the sign says \"Welcome to Northwinter\". Gate keeper is looking at you very suspiciously.'))\n    dispatch(message('Gate Keeper', guid, 'Who the fuck are you?'))\n    dispatch(message('GM' , guid, 'You are quite sure that not giving this man proper answer will get you into trouble. Please type your name.'))\n  },\n  onCommand:(guid, getState, dispatch, command)=>{\n    const name = command\n    dispatch(message('Gate Keeper', guid, `So... Your name is ${command}. I have never heard about you.`))\n    dispatch(message('GM', guid, 'Gate Keeper now looks at you even more suspiciously.'))\n    dispatch(setName(guid, name))\n    dispatch(setState(guid, 'classSelection'))\n  }\n}","import {message, setClass, setState} from '../../model/context-reducer'\n\nconst classes = ['mage', 'warrior', 'priest', 'hunter', 'stone']\nconst gateKeeper = 'Gate Keeper'\n\nexport default {\n  onEnter: (guid, getState, dispatch)=>{\n    dispatch(message(gateKeeper, guid, 'Listen buddy, we have rules here, and the rules are: '+\n      'Every fucker entering that town behind me must be on the list I have here. If not...'))\n    dispatch(message('GM', guid, 'Gate keeper looks at amulet you have on your neck.'))\n\n    dispatch(message(gateKeeper, guid,' well give me a second and I will sign you in.'))\n    dispatch(message(gateKeeper, guid,'I just need to know your class'))\n    dispatch(message('GM', guid, `Available classes are: ${classes.join(', ')} type in the name of the class you want`))\n  },\n  onCommand:(guid, getState, dispatch, command)=>{\n    if(classes.includes(command)){\n      dispatch(message(gateKeeper, guid, 'Yes... yes... we allow those guys in, come in...'))\n      dispatch(setClass(guid, command))\n      dispatch(setState(guid, 'townLobby'))\n    } else {\n      dispatch(message(gateKeeper, guid, `No, we don\\'t allow any ${command} in this town. You must be thinking about something else.`))\n    }\n  }\n}","export function client(rootState, guid){\n  return rootState.contexts[guid].shared\n}","export function name(state){\n  return state.name\n}\n\nexport function className(state){\n  return state.className\n}\n\nexport function actionState(state){\n  return state.actionState\n}\n\nexport function actionStateCount(state){\n  return actionState(state).length\n}\n\nexport function currentActionState(state){\n  return state.actionState[state.actionState.length - 1]\n}\n\nexport function currentActionStateName(state){\n  return currentActionState(state).name\n}","import {message, pushState} from '../../model/context-reducer'\nimport {client} from '../../model/selectors/global'\nimport {name, className} from '../../model/selectors/client'\nimport log from '../log'\n\nconst GM = 'GM'\n\nexport default {\n  onEnter: (guid, getState, dispatch)=>{\n    dispatch(message(GM, guid, 'You are entering the town area. You see your friends here.'))\n  },\n  onReturn:(guid, getState, dispatch, fromState)=>{\n    log.info(`${guid} Return from state: `, fromState)\n  },\n  onCommand:(guid, getState, dispatch, command)=>{\n    const state = getState()\n    if(command === '/roll'){\n      dispatch(pushState(guid, 'rollDices'))\n    } else{\n      dispatch(message(`${name(client(state, guid))}[${className(client(state, guid))}]`, 'all', command))\n    }\n  }\n}","import {currentActionState} from './client'\n\nexport function numberOfRerolls(state){\n  return currentActionState(state).numberOfRolls || 0\n}\n\nexport function rolledDices(state) {\n  return currentActionState(state).rolledDices || []\n}\n\nexport function locks(state){\n  return currentActionState(state).locks || []\n}","import {message, popState} from '../../model/context-reducer'\nimport {client} from '../../model/selectors/global'\nimport {name, className} from '../../model/selectors/client'\nimport {randomInt, uniqueArray} from '../../utils'\nimport {roll, lock} from '../../model/client-action-state/roll-dices'\nimport {numberOfRerolls, rolledDices, locks} from '../../model/selectors/client-action-state'\nimport log from '../log'\n\nfunction onFinishRolling(getState, guid, dispatch){\n  const state = getState()\n  const player = `${name(client(state, guid))}[${className(client(state, guid))}]`\n  dispatch(message('GM', 'all', `${player} is rolling: ${rolledDices(client(state, guid))}`))\n  dispatch(popState(guid))\n}\n\nexport default {\n  onEnter: (guid, getState, dispatch)=>{\n    const firstRoll = [randomInt(1,7),randomInt(1,7), randomInt(1,7), randomInt(1,7)]\n    const locks = [false, false, false, false]\n    dispatch(roll(guid, firstRoll))\n    dispatch(lock(guid, locks))\n    /*dispatch(message('GM', guid, `Your initial roll is: ${firstRoll}.` +\n      'If you want to reroll, type /reroll <number> ... <number>. Where <number> is index of dice you want to reroll or /keep'))\n    */\n  },\n  onCommand:(guid, getState, dispatch, command)=>{\n    const state = getState()\n    if(command.startsWith('/reroll')){\n      const currentDices = rolledDices(client(state, guid))\n      const currentLocks = locks(client(state, guid))\n      const newDices = currentDices.map((el,index) => {\n        if(!currentLocks[index]){\n          return randomInt(1,7)\n        } else {\n          return el\n        }\n      })\n      //dispatch(message('GM', guid, `After ${numberOfRerolls(client(state, guid))} rerolls, you have: ${newDices}`))\n\n      dispatch(roll(guid, newDices))\n    } else if(command.startsWith('/keep')){\n      onFinishRolling(state, guid, dispatch)\n    } else if(command.startsWith('/lock')){\n      const splited = command.split(' ')\n      if(splited.length === 2){\n        const index = +(splited[1])\n        const currentLocks = locks(client(state, guid))\n        let newLocks = currentLocks.slice(0,currentLocks.length)\n        newLocks[index] = !newLocks[index]\n        dispatch(lock(guid, newLocks))\n      }\n    } else {\n      dispatch(message('GM', guid, 'Unrecognized command, please use /reroll <number> ... <number> or /keep'))\n    }\n    if(numberOfRerolls(client(state, guid)) >= 2){\n      onFinishRolling(getState, guid, dispatch)\n    }\n  }\n}","import * as actionStateHandlers from './../states'\nimport log from '../log'\nimport {client} from '../../model/selectors/global'\nimport {actionStateCount, currentActionStateName, currentActionState} from '../../model/selectors/client'\n\nexport default function serverMiddleware({ getState, dispatch }) {\n  return (next) => (action) => {\n    if (action.type === 'CONTEXT_SPAWNED') {\n      const result = next(action)\n      if (actionStateCount(client(getState(), action.guid)) === 0) {\n        dispatch({\n          type: 'CLIENT_STATE_ENTER_PUSH',\n          guid: action.guid,\n          name: 'introduction'\n        })\n      }\n      return result\n    } else if (action.type === 'CLIENT_STATE_ENTER_PUSH' || action.type === 'CLIENT_STATE_ENTER_REPLACE') {\n      const result = next(action)\n      if (actionStateCount(client(getState(), action.guid)) > 0) {\n        const name = currentActionStateName(client(getState(), action.guid))\n        log.info(`${action.guid} entering state ${name}`)\n        if(actionStateHandlers[name].onEnter){\n          actionStateHandlers[name].onEnter(action.guid, getState, dispatch)\n        }\n      }\n      return result\n    } else if(action.type === 'CLIENT_STATE_POP'){\n      const fromStateName = currentActionStateName(client(getState(), action.guid))\n      const fromStateInternalState = currentActionState(client(getState(), action.guid))\n      const result = next(action)\n      if (actionStateCount(client(getState(), action.guid)) > 0) {\n        const name = currentActionStateName(client(getState(), action.guid))\n        log.info(`${action.guid} returning from ${fromStateName} state  to ${name} state`)\n        if (actionStateHandlers[name].onReturn) {\n          actionStateHandlers[name].onReturn(action.guid, getState, dispatch, fromStateName, fromStateInternalState)\n        }\n      }\n      return result\n    } else if(action.type === 'COMMAND_REQUEST'){\n      if (actionStateCount(client(getState(), action.guid)) > 0) {\n        const name = currentActionStateName(client(getState(), action.guid))\n        actionStateHandlers[name].onCommand(action.guid, getState, dispatch, action.command)\n      }\n    } else {\n      return next(action)\n    }\n  }\n}","import {shallowEqual} from '../../utils'\nimport log from '../log'\n\nexport default function serverMiddleware(clientGuidToSocket, { getState, dispatch }) {\n  return (next) => (action) => {\n    log.info(`Action ${JSON.stringify(action)}`)\n    const stateBeforeRequest = getState()\n    const result = next(action)\n    const stateAfterRequest = getState()\n    Object.keys(stateBeforeRequest.contexts).forEach((key) => {\n\n      const stateChanged = !shallowEqual(stateBeforeRequest.contexts[key].shared, stateAfterRequest.contexts[key].shared)\n      const targetSocket = clientGuidToSocket[key]\n      if(stateChanged){\n        log.info(`After ${action.type} state for ${key} changed, sending action`)\n        targetSocket.emit('action', action)\n      } else {\n        log.info(`After ${action.type} state for ${key} is same`)\n      }\n    })\n    return result\n  }\n}","import fs from 'fs'\nimport path from 'path'\nimport globalReducer from 'model/global-reducer'\nimport serverMiddleware from './middleware/server-middleware'\nimport responseMiddleware from './middleware/response-middleware'\nimport log from './log'\nimport {createStore, applyMiddleware} from 'redux'\n\nconst dataDirPath = path.join(__dirname, 'data')\nconst stateFilePath = path.join(__dirname, 'data/state.json')\n\nconst clientSocketIdToGuid = {}\nconst clientGuidToSocket = {}\n\nif (!fs.existsSync(dataDirPath)){\n  fs.mkdirSync(dataDirPath)\n}\nlet stateStr = '{}'\ntry {\n  stateStr = fs.readFileSync(stateFilePath, 'utf8')\n} catch(e) {\n  fs.writeFileSync(stateFilePath, '{}', { flag: 'wx' })\n}\n\nif(stateStr.trim().length === 0) stateStr = '{}'\nconst store = createStore(globalReducer, JSON.parse(stateStr), applyMiddleware(serverMiddleware,responseMiddleware.bind(undefined,clientGuidToSocket)))\n\nstore.subscribe(function persistState(){\n  const currentState = store.getState()\n  if(currentState === undefined){\n    log.warn('Saving empty state.')\n  } else {\n    fs.writeFileSync(stateFilePath, JSON.stringify(currentState, null, 2))\n  }\n})\n\nexport default function onSocket(io, socket){\n  const ipAddress = socket.request.connection.remoteAddress\n  const clientId = `${ipAddress}`\n  log.info(`client ??@${clientId} connected`)\n\n  socket.on('authentication', function(authToken){\n    clientSocketIdToGuid[socket.id] = authToken\n    clientGuidToSocket[authToken] = socket\n    log.info(`client ??@${clientId} authenticated as ${authToken}`)\n    store.dispatch({\n      type: 'CONTEXT_SPAWNED',\n      guid: authToken\n    })\n    socket.emit('initial_state', store.getState().contexts[authToken].shared)\n  })\n\n  socket.on('disconnect', function() {\n    log.info(`client ${clientSocketIdToGuid[socket.id]}@${clientId} disconnected`)\n    store.dispatch({\n      type: 'CONTEXT_DESPAWNED',\n      guid: clientSocketIdToGuid[socket.id]\n    })\n    clientGuidToSocket[clientSocketIdToGuid[socket.id]] = undefined\n    clientSocketIdToGuid[socket.id] = undefined\n  })\n\n  socket.on('command_request', function(action){\n    if(action.type !== 'COMMAND_REQUEST') return\n    log.info(`client ${clientSocketIdToGuid[socket.id]}@${clientId} command:${JSON.stringify(action.command)}`)\n    store.dispatch({\n      type: action.type,\n      guid: clientSocketIdToGuid[socket.id],\n      command: action.command\n    })\n  })\n}\n","import express from 'express'\nimport path from 'path'\nimport http from 'http'\nimport socketIO from 'socket.io'\n\nimport log from './log'\nimport serverIO from './server-io'\n\nconst app = express()\nconst host = '0.0.0.0'\nconst port = process.env.PORT || 8080\n\nprocess.env.PWD = process.cwd()\n\napp.use('/public', express.static(path.join(process.env.PWD, 'public')))\n\napp.get('/favicon.ico', function(req, res) {\n  res.sendFile(path.join(process.env.PWD, 'public/favicon.ico'))\n})\n\napp.get('/', function(req, res) {\n  res.sendFile(path.join(process.env.PWD, 'public/index.html'))\n})\n\nconst server = http.createServer(app)\nconst io = socketIO(server)\n\nio.on('connection', serverIO.bind(undefined, io))\n\nserver.listen(port, host, function(err) {\n  if (err) log.error(err)\n  else {\n    log.info(`Listening at http://${host}:${port}`)\n  }\n})\n"],"names":["winston","require","path","logger","Logger","transports","Console","File","filename","join","__dirname","args","debug","info","warn","error","s4","Math","floor","random","toString","substring","guid","randomInt","min","max","ceil","shallowEqual","oldState","newState","resultOldToNew","Object","keys","reduce","result","oldKey","resultNewToOld","newKey","changed","ROLL","LOCK","roll","rolledDices","lock","locks","initialState","rollDices","state","action","type","numberOfRolls","introduction","classSelection","townLobby","actionStateReducer","concat","clientActionReducers","name","undefined","slice","length","topState","topStateName","reducer","newTopState","message","from","to","guidGenerator","setState","pushState","popState","setName","setClass","className","contextReducer","messages","id","actionState","sharedContextReducer","clientContextReducer","shared","allContextsReducer","context","combineReducers","getState","dispatch","command","classes","gateKeeper","includes","client","rootState","contexts","actionStateCount","currentActionState","currentActionStateName","GM","fromState","numberOfRerolls","onFinishRolling","player","firstRoll","startsWith","currentDices","currentLocks","newDices","map","el","index","splited","split","newLocks","serverMiddleware","next","actionStateHandlers","onEnter","fromStateName","fromStateInternalState","onReturn","onCommand","clientGuidToSocket","JSON","stringify","stateBeforeRequest","stateAfterRequest","forEach","key","stateChanged","targetSocket","emit","dataDirPath","stateFilePath","clientSocketIdToGuid","fs","existsSync","mkdirSync","stateStr","readFileSync","e","writeFileSync","flag","trim","store","createStore","globalReducer","parse","applyMiddleware","responseMiddleware","bind","subscribe","persistState","currentState","onSocket","io","socket","ipAddress","request","connection","remoteAddress","clientId","on","authToken","app","express","host","port","process","env","PORT","PWD","cwd","use","static","get","req","res","sendFile","server","http","createServer","socketIO","serverIO","listen","err","log"],"mappings":"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"}